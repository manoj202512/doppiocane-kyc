<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure KYC Application | Doppiocane Financial Services</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            font-size: 14px;
        }

        .security-badge svg {
            width: 20px;
            height: 20px;
        }

        .progress-bar {
            background: #f0f0f0;
            height: 6px;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 33.33%;
            transition: width 0.3s ease;
        }

        .form-content {
            padding: 40px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-title {
            font-size: 24px;
            font-weight: 700;
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .step-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 30px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        label .required {
            color: #e74c3c;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .file-upload-area {
            border: 2px dashed #667eea;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9ff;
        }

        .file-upload-area:hover {
            background: #f0f2ff;
            border-color: #4c63d2;
        }

        .file-upload-area input[type="file"] {
            display: none;
        }

        .upload-icon {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .file-list {
            margin-top: 15px;
        }

        .file-item {
            background: #f5f5f5;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-item button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-top: 3px;
        }

        .checkbox-group label {
            font-size: 13px;
            font-weight: 400;
            color: #555;
            margin: 0;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .success-message {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }

        .success-message.active {
            display: block;
        }

        .success-icon {
            font-size: 80px;
            color: #27ae60;
            margin-bottom: 20px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .alert-info {
            background: #e3f2fd;
            color: #1565c0;
            border-left: 4px solid #1565c0;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-content {
                padding: 20px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔒 Secure KYC Application</h1>
            <p>Complete your identity verification in 3 simple steps</p>
            <div class="security-badge">
                <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path></svg>
                256-bit SSL Encrypted | Bank-Grade Security
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="form-content">
            <form id="kycForm" method="POST" enctype="multipart/form-data">
                
                <!-- STEP 1: Personal Information -->
                <div class="step active" data-step="1">
                    <h2 class="step-title">Personal Information</h2>
                    <p class="step-subtitle">Please provide your complete personal details</p>

                    <div class="form-row">
                        <div class="form-group">
                            <label>First Name <span class="required">*</span></label>
                            <input type="text" name="first_name" id="first_name" required>
                        </div>
                        <div class="form-group">
                            <label>Middle Name</label>
                            <input type="text" name="middle_name" id="middle_name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Last Name <span class="required">*</span></label>
                            <input type="text" name="last_name" id="last_name" required>
                        </div>
                        <div class="form-group">
                            <label>Date of Birth <span class="required">*</span></label>
                            <input type="date" name="date_of_birth" id="date_of_birth" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Social Security Number / National ID <span class="required">*</span></label>
                            <input type="text" name="ssn_or_national_id" id="ssn_or_national_id" required placeholder="XXX-XX-XXXX">
                        </div>
                        <div class="form-group">
                            <label>Gender <span class="required">*</span></label>
                            <select name="gender" id="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                                <option value="prefer_not_to_say">Prefer not to say</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Citizenship <span class="required">*</span></label>
                            <input type="text" name="citizenship" id="citizenship" required placeholder="e.g., United States">
                        </div>
                        <div class="form-group">
                            <label>Marital Status <span class="required">*</span></label>
                            <select name="marital_status" id="marital_status" required>
                                <option value="">Select Status</option>
                                <option value="single">Single</option>
                                <option value="married">Married</option>
                                <option value="divorced">Divorced</option>
                                <option value="widowed">Widowed</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Email Address <span class="required">*</span></label>
                            <input type="email" name="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number <span class="required">*</span></label>
                            <input type="tel" name="phone_number" id="phone_number" required placeholder="+1 (555) 123-4567">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Secondary Phone Number (Optional)</label>
                        <input type="tel" name="secondary_phone" id="secondary_phone" placeholder="+1 (555) 123-4567">
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn-primary" onclick="nextStep()">Next Step →</button>
                    </div>
                </div>

                <!-- STEP 2: Address & Employment -->
                <div class="step" data-step="2">
                    <h2 class="step-title">Address & Employment Details</h2>
                    <p class="step-subtitle">Where do you live and work?</p>

                    <div class="alert alert-info">
                        <strong>Note:</strong> Your residential address must match your government-issued ID.
                    </div>

                    <div class="form-group">
                        <label>Street Address <span class="required">*</span></label>
                        <input type="text" name="street_address" id="street_address" required placeholder="123 Main Street, Apt 4B">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>City <span class="required">*</span></label>
                            <input type="text" name="city" id="city" required>
                        </div>
                        <div class="form-group">
                            <label>State/Province <span class="required">*</span></label>
                            <input type="text" name="state" id="state" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Postal/ZIP Code <span class="required">*</span></label>
                            <input type="text" name="postal_code" id="postal_code" required>
                        </div>
                        <div class="form-group">
                            <label>Country <span class="required">*</span></label>
                            <input type="text" name="country" id="country" required value="United States">
                        </div>
                    </div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid #f0f0f0;">

                    <h3 style="font-size: 18px; margin-bottom: 20px; color: #1e3c72;">Employment Information</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Employment Status <span class="required">*</span></label>
                            <select name="employment_status" id="employment_status" required>
                                <option value="">Select Status</option>
                                <option value="employed">Employed</option>
                                <option value="self_employed">Self-Employed</option>
                                <option value="unemployed">Unemployed</option>
                                <option value="retired">Retired</option>
                                <option value="student">Student</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Employer Name</label>
                            <input type="text" name="employer_name" id="employer_name" placeholder="Company Name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Job Title/Position</label>
                            <input type="text" name="job_title" id="job_title" placeholder="Software Engineer">
                        </div>
                        <div class="form-group">
                            <label>Annual Income (USD) <span class="required">*</span></label>
                            <select name="annual_income" id="annual_income" required>
                                <option value="">Select Range</option>
                                <option value="under_25k">Under $25,000</option>
                                <option value="25k_50k">$25,000 - $50,000</option>
                                <option value="50k_75k">$50,000 - $75,000</option>
                                <option value="75k_100k">$75,000 - $100,000</option>
                                <option value="100k_150k">$100,000 - $150,000</option>
                                <option value="over_150k">Over $150,000</option>
                            </select>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn-secondary" onclick="prevStep()">← Previous</button>
                        <button type="button" class="btn-primary" onclick="nextStep()">Next Step →</button>
                    </div>
                </div>

                <!-- STEP 3: Documents & Consent -->
                <div class="step" data-step="3">
                    <h2 class="step-title">Document Upload & Consent</h2>
                    <p class="step-subtitle">Upload your identification documents</p>

                    <div class="alert alert-info">
                        <strong>Accepted Documents:</strong> Passport, Driver's License, National ID Card, Utility Bill, Bank Statement
                    </div>

                    <div class="form-group">
                        <label>Government-Issued Photo ID <span class="required">*</span></label>
                        <div class="file-upload-area" onclick="document.getElementById('photo_id').click()">
                            <div class="upload-icon">📄</div>
                            <p><strong>Click to upload</strong> or drag and drop</p>
                            <p style="font-size: 12px; color: #999; margin-top: 5px;">PNG, JPG, PDF up to 10MB</p>
                            <input type="file" id="photo_id" name="photo_id[]" accept=".jpg,.jpeg,.png,.pdf" multiple>
                        </div>
                        <div class="file-list" id="photoIdList"></div>
                    </div>

                    <div class="form-group">
                        <label>Proof of Address <span class="required">*</span></label>
                        <div class="file-upload-area" onclick="document.getElementById('proof_address').click()">
                            <div class="upload-icon">🏠</div>
                            <p><strong>Click to upload</strong> utility bill or bank statement</p>
                            <p style="font-size: 12px; color: #999; margin-top: 5px;">Must be dated within last 3 months</p>
                            <input type="file" id="proof_address" name="proof_address[]" accept=".jpg,.jpeg,.png,.pdf" multiple>
                        </div>
                        <div class="file-list" id="proofAddressList"></div>
                    </div>

                    <div class="form-group">
                        <label>Proof of Income (Optional)</label>
                        <div class="file-upload-area" onclick="document.getElementById('proof_income').click()">
                            <div class="upload-icon">💰</div>
                            <p><strong>Click to upload</strong> pay stub or tax return</p>
                            <input type="file" id="proof_income" name="proof_income[]" accept=".jpg,.jpeg,.png,.pdf" multiple>
                        </div>
                        <div class="file-list" id="proofIncomeList"></div>
                    </div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid #f0f0f0;">

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="terms_consent" name="terms_consent" required>
                            <label for="terms_consent">
                                I certify that all information provided is accurate and I consent to Doppiocane Financial Services verifying my identity through third-party services. <span class="required">*</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="privacy_consent" name="privacy_consent" required>
                            <label for="privacy_consent">
                                I have read and agree to the Privacy Policy and Terms of Service. <span class="required">*</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn-secondary" onclick="prevStep()">← Previous</button>
                        <button type="submit" class="btn-primary">Submit Application ✓</button>
                    </div>
                </div>

                <!-- SUCCESS MESSAGE -->
                <div class="success-message" id="successMessage">
                    <div class="success-icon">✅</div>
                    <h2 style="color: #27ae60; margin-bottom: 15px;">Application Submitted Successfully!</h2>
                    <p style="color: #666; font-size: 16px; margin-bottom: 10px;">
                        Your application ID: <strong id="applicationId"></strong>
                    </p>
                    <p style="color: #999; font-size: 14px;">
                        We'll review your application within 24-48 hours and send updates to your email.
                    </p>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 3;

        // File upload handlers
        const fileInputs = {
            photo_id: { input: document.getElementById('photo_id'), list: document.getElementById('photoIdList'), files: [] },
            proof_address: { input: document.getElementById('proof_address'), list: document.getElementById('proofAddressList'), files: [] },
            proof_income: { input: document.getElementById('proof_income'), list: document.getElementById('proofIncomeList'), files: [] }
        };

        Object.keys(fileInputs).forEach(key => {
            fileInputs[key].input.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                fileInputs[key].files = fileInputs[key].files.concat(files);
                displayFiles(key);
            });
        });

        function displayFiles(inputName) {
            const { list, files } = fileInputs[inputName];
            list.innerHTML = '';
            files.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span>${file.name} (${(file.size / 1024).toFixed(2)} KB)</span>
                    <button type="button" onclick="removeFile('${inputName}', ${index})">Remove</button>
                `;
                list.appendChild(fileItem);
            });
        }

        function removeFile(inputName, index) {
            fileInputs[inputName].files.splice(index, 1);
            displayFiles(inputName);
        }

        function nextStep() {
            if (!validateStep(currentStep)) return;
            
            if (currentStep < totalSteps) {
                document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
                currentStep++;
                document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
                currentStep--;
                document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function validateStep(step) {
            const currentStepElement = document.querySelector(`[data-step="${step}"]`);
            const requiredInputs = currentStepElement.querySelectorAll('[required]');
            
            for (let input of requiredInputs) {
                if (!input.value.trim()) {
                    input.focus();
                    alert('Please fill in all required fields');
                    return false;
                }
            }
            return true;
        }

        document.getElementById('kycForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validateStep(currentStep)) return;

            const formData = new FormData(this);
            
            // Add uploaded files
            Object.keys(fileInputs).forEach(key => {
                fileInputs[key].files.forEach(file => {
                    formData.append(key + '[]', file);
                });
            });

            // Add consent timestamp
            formData.append('consent_timestamp', new Date().toISOString());

            try {
                const response = await fetch('enterprise-kyc-form.php', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('applicationId').textContent = result.application_id;
                    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                    document.getElementById('successMessage').classList.add('active');
                } else {
                    alert('Submission failed: ' + result.message);
                }
            } catch (error) {
                alert('Error submitting form. Please try again.');
                console.error(error);
            }
        });
    </script>
</body>
</html>

